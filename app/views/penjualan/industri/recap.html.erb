<div class="content-heading">
  Dashboard INDUSTRI Report In <b><%= params[:date].present? ? Date::MONTHNAMES[params[:date][:month].to_i] : Date::MONTHNAMES[Date.today.month] %>
  <%= params[:date].present? ? params[:date][:year] : Date.today.year %></b>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    Search by Month Form
  </div>
  <div class="panel-body">
    <%= form_tag(request.fullpath, {method: :get, :class => "form-inline"}) do %>
    <div class="form-group">
      <%= select_month(params[:date].present? ? params[:date][:month].to_i : Date.today.month, {prompt: 'Choose month'}, class: "form-control") %>
    </div>
    <div class="form-group">
      <%= select_year(params[:date].present? ? params[:date][:year].to_i : Date.today.year, {start_year: 2020, end_year: Date.today.year, prompt: 'Choose year'}, {class: "form-control"}) %>
    </div>
    <%= submit_tag 'Search', name: nil, class: "btn btn-info" %>
    <% end %>
  </div>
</div>

<div class="row">
  <div class="col-lg-12">
    <!-- START content-->
    <div class="row">
      <div class="col-lg-12">
        <div class="panel panel-warning">
          <div class="panel-heading" style="text-align: center">
            Total Revenue <b>INDUSTRI</b>
          </div>
          <div class="panel-body">
            <table id="datatable1" class="table table-striped table-bordered nowrap">
              <thead>
                <tr>
                  <th rowspan="2">Total</th>
                  <th colspan="2"><%= (@date.to_date - 5).end_of_month.to_date.strftime('%b %y') %></th>
                  <th colspan="2"><%= ((@date.to_date - 5).last_month).strftime('%b %y') %></th>
                  <th rowspan="2">Change</th>
                </tr>
                <tr>
                  <th>IDR</th>
                  <th>M3</th>
                  <th>IDR</th>
                  <th>M3</th>
                </tr>
              </thead>
              <tbody>
                <% @summary.each do |dp| %>
                <tr class="gradeX">
                  <td>Total</td>
                  <td><%= currency(dp.monthnow) %></td>
                  <td><%= currency(dp.kubikasinow) %></td>
                  <td><%= currency(dp.month1) %></td>
                  <td><%= currency(dp.kubikasi1) %></td>
                  <td class="<%= coloring(dp.percentage) %>"><%= dp.percentage.nil? ? 0 : cpercent(dp.percentage.abs) %></td>
                </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <!-- END content-->
  </div>
  <div class="col-lg-6">
    <!-- START content-->
    <div class="row">
      <div class="col-lg-12">
        <div class="panel panel-info">
          <div class="panel-heading" style="text-align: center">
            Sales Report by Brand <b>INDUSTRI</b>
          </div>
          <div class="panel-body">
            <table id="nasional_bybrand" class="table table-striped table-bordered nowrap">
              <thead>
                <tr>
                  <th rowspan="2">Brand</th>
                  <th colspan="2"><%= (@date.to_date - 5).end_of_month.to_date.strftime('%b %y') %></th>
                  <th colspan="2"><%= ((@date.to_date - 5).last_month).strftime('%b %y') %></th>
                  <th rowspan="2">Change</th>
                </tr>
                <tr>
                  <th>IDR</th>
                  <th>M3</th>
                  <th>IDR</th>
                  <th>M3</th>
                </tr>
              </thead>
              <tbody>
                <% @monthnas_summary.each do |dp| %>
                <tr class="gradeX">
                  <td><%= dp.brand %></td>
                  <td><%= currency(dp.val_1) %></td>
                  <td><%= currency(dp.kubikasi1) %></td>
                  <td><%= currency(dp.val_2) %></td>
                  <td><%= currency(dp.kubikasi2) %></td>
                  <td class="<%= coloring(dp.percentage) %>"><%= dp.percentage.nil? ? 0 : cpercent(dp.percentage.abs) %></td>
                </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <!-- END content-->
  </div>
  <div class="col-lg-6">
    <!-- START content-->
    <div class="row">
      <div class="col-lg-12">
        <div class="panel panel-info">
          <div class="panel-heading" style="text-align: center">
            Sales Report by Sub-Brand <b>INDUSTRI</b>
          </div>
          <div class="panel-body">
            <table id="nasional_bysubbrand" class="table table-striped table-bordered nowrap">
              <thead>
                <tr>
                  <th rowspan="2">Sub-Brand</th>
                  <th colspan="2"><%= (@date.to_date - 5).strftime("%B") %></th>
                  <th colspan="2"><%= ((@date.to_date - 5).last_month).to_date.strftime("%B") %></th>
                  <th rowspan="2">Change</th>
                </tr>
                <tr>
                  <th>IDR</th>
                  <th>M3</th>
                  <th>IDR</th>
                  <th>M3</th>
                </tr>
              </thead>
              <tbody>
                <% @bybrand.each do |bb| %>
                <tr class="gradeX">
                  <th><%= bb.subbrand %></th>
                  <td><%= bb.monthnow.nil? ? 0 : currency(bb.monthnow) %></td>
                  <td><%= bb.kubikasinow.nil? ? 0 : currency(bb.kubikasinow) %></td>
                  <td><%= bb.month1.nil? ? 0 : currency(bb.month1) %></td>
                  <td><%= bb.kubikasi1.nil? ? 0 : currency(bb.kubikasi1) %></td>
                  <td class="<%= coloring(bb.percentage) %>"><%= bb.percentage.nil? ? 0 : cpercent(bb.percentage.abs) %></td>
                </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <!-- END content-->
  </div>
  <div class="col-lg-12">
    <!-- START content-->
    <div class="row">
      <div class="col-lg-12">
        <div class="panel panel-info">
          <div class="panel-heading" style="text-align: center">
            Sales Report by Customer <b>INDUSTRI</b>
          </div>
          <div class="panel-body">
            <table id="table-revenue-products" class="table table-striped table-bordered nowrap" style="width:100%">
              <thead>
              	<tr>
                  <th rowspan="2">Channel</th>
                  <th rowspan="2">Salesman</th>
                  <th rowspan="2">Kode</th>
                  <th rowspan="2">Customer</th>
                  <th colspan="3"><%= (@date.to_date - 5).strftime("%B") %></th>
                  <th colspan="3"><%= ((@date.to_date - 5).last_month).to_date.strftime("%B") %></th>
                  <th colspan="3"><%= ((@date.to_date - 5).last_month.last_month).to_date.strftime("%B") %></th>
              	</tr>
                <tr>
                  <th>IDR</th>
                  <th>USD</th>
                  <th>M3</th>
                  <th>IDR</th>
                  <th>USD</th>
                  <th>M3</th>
                  <th>IDR</th>
                  <th>USD</th>
                  <th>M3</th>
                </tr>
              </thead>
              <tbody>
                <% @customer.each do |cus| %>
                <tr>
                  <td><%= cus.channel %></td>
                  <td><%= cus.salesman %></td>
                  <td><%= cus.customer_id %></td>
                  <td><%= cus.customer_desc %></td>
                  <td><%= cus.monthnow.nil? ? 0 : currency(cus.monthnow) %></td>
                  <td><%= cus.monthnow.nil? ? 0 : currency(cus.monthnow_usd) %></td>
                  <td><%= cus.kubikasinow.nil? ? 0 : currency(cus.kubikasinow) %></td>
                  <td><%= cus.month1.nil? ? 0 : currency(cus.month1) %></td>
                  <td><%= cus.month1.nil? ? 0 : currency(cus.month1_usd) %></td>
                  <td><%= cus.kubikasi1.nil? ? 0 : currency(cus.kubikasi1) %></td>
                  <td><%= cus.month2.nil? ? 0 : currency(cus.month2) %></td>
                  <td><%= cus.month2.nil? ? 0 : currency(cus.month2_usd) %></td>
                  <td><%= cus.kubikasi2.nil? ? 0 : currency(cus.kubikasi2) %></td>
                </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <!-- END content-->
  </div>
  <div class="col-lg-12">
    <!-- START content-->
    <div class="row">
      <div class="col-lg-12">
        <div class="panel panel-info">
          <div class="panel-heading" style="text-align: center">
            Sales Report by Customer and Sub-Brand <b>INDUSTRI</b>
          </div>
          <div class="panel-body">
            <table id="channel_customerbysubbrand" class="table table-striped table-bordered nowrap" style="width:100%">
              <thead>
              	<tr>
                  <th rowspan="2">Salesman</th>
                  <th rowspan="2">Customer</th>
                  <th rowspan="2">Sub-Brand</th>
                  <th colspan="3"><%= (@date.to_date - 5).strftime("%B") %></th>
                  <th colspan="3"><%= ((@date.to_date - 5).last_month).to_date.strftime("%B") %></th>
                  <th colspan="3"><%= ((@date.to_date - 5).last_month.last_month).to_date.strftime("%B") %></th>
              	</tr>
                <tr>
                  <th>IDR</th>
                  <th>USD</th>
                  <th>M3</th>
                  <th>IDR</th>
                  <th>USD</th>
                  <th>M3</th>
                  <th>IDR</th>
                  <th>USD</th>
                  <th>M3</th>
                </tr>
              </thead>
              <tbody>
                <% @customer_subbrand.each do |cus| %>
                <tr>
                  <td><%= cus.salesman %></td>
                  <td><%= cus.customer_desc %></td>
                  <td><%= cus.subbrand %></td>
                  <td><%= cus.monthnow.nil? ? 0 : currency(cus.monthnow) %></td>
                  <td><%= cus.monthnow.nil? ? 0 : currency(cus.monthnow_usd) %></td>
                  <td><%= cus.kubikasinow.nil? ? 0 : currency(cus.kubikasinow) %></td>
                  <td><%= cus.month1.nil? ? 0 : currency(cus.month1) %></td>
                  <td><%= cus.month1.nil? ? 0 : currency(cus.month1_usd) %></td>
                  <td><%= cus.kubikasi2.nil? ? 0 : currency(cus.kubikasi2) %></td>
                  <td><%= cus.month2.nil? ? 0 : currency(cus.month2) %></td>
                  <td><%= cus.month2.nil? ? 0 : currency(cus.month2_usd) %></td>
                  <td><%= cus.kubikasi2.nil? ? 0 : currency(cus.kubikasi2) %></td>
                </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <!-- END content-->
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    Search by Month Form
  </div>
  <div class="panel-body">
    <%= form_tag(request.fullpath, {method: :get, :class => "form-inline"}) do %>
    <div class="form-group">
      <%= select_month(params[:date].present? ? params[:date][:month].to_i : Date.today.month, {prompt: 'Choose month'}, class: "form-control") %>
    </div>
    <div class="form-group">
      <%= select_year(params[:date].present? ? params[:date][:year].to_i : Date.today.year, {start_year: 2020, end_year: Date.today.year, prompt: 'Choose year'}, {class: "form-control"}) %>
    </div>
    <%= submit_tag 'Search', name: nil, class: "btn btn-info" %>
    <% end %>
  </div>
</div>
